<!doctype html>
<html lang="zh-CN">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width,initial-scale=1,viewport-fit=cover">
<title>å¿«æ’­å½±è§†é›†å›¢</title>
<style>
*{box-sizing:border-box}
body{margin:0;font-family:-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto;background:#f4f6f9;
padding-top:env(safe-area-inset-top);padding-bottom:env(safe-area-inset-bottom)}
.header{background:#0f172a;color:#fff;padding:14px;text-align:center;font-size:18px;font-weight:600}
.wrap{max-width:520px;margin:0 auto;padding:12px}
.card{background:#fff;border-radius:14px;padding:14px;box-shadow:0 8px 20px rgba(0,0,0,.08)}
select,button{width:100%;padding:14px;margin-top:10px;font-size:16px;border-radius:12px}
button{background:#2563eb;color:#fff;border:none}
.info{display:none;margin-top:10px}
.price{font-size:20px;font-weight:700;color:#16a34a}
.desc{font-size:14px;color:#475569;margin-top:6px}
.addr{background:#f1f5f9;padding:10px;border-radius:10px;font-size:13px;word-break:break-all}
.notice{font-size:13px;color:#64748b;margin-top:8px;line-height:1.4}
.pay-icons{display:flex;gap:12px;margin-top:10px;font-size:14px;color:#64748b}
.pay-icons .on{color:#111;font-weight:600}
.copy{display:flex;gap:8px;align-items:center;margin-top:6px}
.copy button{padding:8px 12px;font-size:14px}
.qr{display:block;margin:12px auto;width:200px;height:auto;border-radius:10px}
</style>
</head>
<body>
<div class="header">å¿«æ’­å½±è§†é›†å›¢</div>
<div class="wrap">
  <div class="card">
    <select id="pkg">
      <option value="">è¯·é€‰æ‹©å¥—é¤</option>
      <option value="p1" data-base="15" data-desc="æµ‹è¯•1">å¥—é¤ä¸€</option>
      <option value="p2" data-base="76" data-desc="æµ‹è¯•2">å¥—é¤äºŒ</option>
      <option value="p3" data-base="76" data-desc="æµ‹è¯•3">å¥—é¤ä¸‰</option>
      <option value="sv" data-base="160" data-desc="æµ‹è¯•3">SVIP</option>
    </select>

    <div class="info" id="info">
      <div class="desc" id="desc"></div>
      <div class="price">åº”ä»˜é‡‘é¢ï¼š<span id="amount"></span> USDT</div>

      <div class="pay-icons">
        <span>ğŸ’¬ å¾®ä¿¡ï¼ˆç»´æŠ¤ä¸­ï¼‰</span>
        <span>ğŸ’° æ”¯ä»˜å®ï¼ˆç»´æŠ¤ä¸­ï¼‰</span>
        <span class="on">â‚® USDT</span>
      </div>

      <div class="notice">æ”¶æ¬¾åœ°å€ï¼ˆTRC20ï¼‰</div>
      <div class="addr" id="addr">TL6pvvYphpWshdqJ99mSZCq9izYqt2evyX</div>
      <div class="copy">
        <button id="copyAddr">ä¸€é”®å¤åˆ¶</button>
      </div>

      <img class="qr" src="assets/usdt_qr.jpg" alt="USDT TRC20 äºŒç»´ç ">

      <div class="notice" id="status">å·²ç”Ÿæˆè®¢å•ï¼Œè¯·å®Œæˆè½¬è´¦åç‚¹å‡»ã€Œæˆ‘å·²ä»˜æ¬¾ã€</div>
      <button id="paid">æˆ‘å·²ä»˜æ¬¾</button>
    </div>
  </div>
</div>

<script>
var API="https://YOUR_RENDER_BACKEND.onrender.com"; // æ”¹æˆä½ çš„ Render åç«¯
var orderId=null;

var pkg=document.getElementById('pkg');
var info=document.getElementById('info');
var amount=document.getElementById('amount');
var addr=document.getElementById('addr');
var status=document.getElementById('status');
var paid=document.getElementById('paid');
var desc=document.getElementById('desc');
var copyBtn=document.getElementById('copyAddr');

copyBtn.onclick=function(){
  navigator.clipboard.writeText(addr.innerText);
  copyBtn.innerText='å·²å¤åˆ¶';
  setTimeout(()=>copyBtn.innerText='ä¸€é”®å¤åˆ¶',1200);
};

pkg.onchange=async function(){
  if(!this.value) return;
  desc.innerText='å¥—é¤æè¿°ï¼š'+this.selectedOptions[0].dataset.desc;

  var r=await fetch(API+"/api/order",{
    method:"POST",
    headers:{"Content-Type":"application/json"},
    body:JSON.stringify({ base:this.selectedOptions[0].dataset.base })
  });
  var j=await r.json();
  orderId=j.orderId;
  amount.innerText=j.amount;
  info.style.display="block";
};

paid.onclick=async function(){
  var r=await fetch(API+"/api/order/"+orderId);
  var j=await r.json();
  if(j.status==="paid"){
    await navigator.clipboard.writeText(j.code);
    location.href="https://t.me/okklike_bot";
  }else if(j.status==="expired"){
    status.innerText="è®¢å•å·²è¶…æ—¶ï¼Œè¯·é‡æ–°ä¸‹å•";
  }else{
    status.innerText="å°šæœªæ£€æµ‹åˆ°åˆ°è´¦ï¼Œè¯·ç¨åå†è¯•";
  }
};
</script>
</body>
</html>
